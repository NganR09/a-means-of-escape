namespace SpriteKind {
    export const Positioning = SpriteKind.create()
    export const Patient = SpriteKind.create()
    export const enemy_projectile = SpriteKind.create()
    export const Object = SpriteKind.create()
    export const Background = SpriteKind.create()
}
/**
 * The MC's idle animation which triggers when the player isn't moving, making the character seem realistic and human rather than just a block of pixels.
 */
/**
 * Custom key binding?
 */
/**
 * A little introduction to the first patient the player will have to fight in order to help them.
 */
/**
 * Quick explanation of what the player would need to do on each level of the game.
 */
/**
 * Destroys the enemy's sprite if the player manages to destroy it.
 */
/**
 * Overlap event where if the enemy's projectiles overlap the player, the player loses a life.
 */
/**
 * Prevents lag on cool down and frame skipping.
 */
/**
 * Creates a firing animation for the MC.
 */
/**
 * The therapy part of the game where the player's dialogue options impacts the ending they may get.
 */
/**
 * A timer for the player to follow to know how much time they have to find and defeat their patient, otherwise it means a game over.
 */
/**
 * Results screens telling the player how much money they have earnt.
 */
/**
 * The good ending, resulting in a victory for the player.
 */
/**
 * References to the patient's past.
 */
function patients_memories () {
    Gun = sprites.create(assets.image`gun`, SpriteKind.Object)
    tiles.placeOnTile(Gun, tiles.getTileLocation(6, 25))
    Photograph = sprites.create(assets.image`photograph`, SpriteKind.Object)
    tiles.placeOnTile(Photograph, tiles.getTileLocation(11, 61))
    Lighter = sprites.create(assets.image`lighter`, SpriteKind.Object)
    tiles.placeOnTile(Lighter, tiles.getTileLocation(6, 45))
}
sprites.onOverlap(SpriteKind.enemy_projectile, SpriteKind.Player, function (sprite, otherSprite) {
    if (enemy_projectiles.overlapsWith(MC)) {
        sprite.destroy()
        scene.cameraShake(3, 1000)
        info.changeLifeBy(-1)
    }
    if (info.life() == 0) {
        results_screen_2()
    }
})
function set_patient_1_position () {
    patient_1_enemy.destroy()
    enemy_projectiles.destroy()
    sprites.destroyAllSpritesOfKind(SpriteKind.Enemy)
    sprites.destroyAllSpritesOfKind(SpriteKind.Projectile)
    patient_1 = sprites.create(assets.image`Patient_1_true_form`, SpriteKind.Patient)
    patient_1.ay = gravity
    tiles.placeOnTile(patient_1, tiles.getTileLocation(14, 96))
    pause(2000)
    info.stopCountdown()
    results_screen_1()
}
function game_timer_1 () {
    info.startCountdown(300)
}
/**
 * MC's firing animation
 */
controller.B.onEvent(ControllerButtonEvent.Pressed, function () {
    if (characterAnimations.matchesRule(MC, characterAnimations.rule(Predicate.FacingRight))) {
        animation.runImageAnimation(
        MC,
        assets.animation`MC firing animation right`,
        1000,
        false
        )
    }
    if (characterAnimations.matchesRule(MC, characterAnimations.rule(Predicate.FacingLeft))) {
        animation.runImageAnimation(
        MC,
        assets.animation`MC firing animation left`,
        1000,
        false
        )
    }
    set_MC_projectiles()
    music.setVolume(80)
    music.playSoundEffect(music.createSoundEffect(WaveShape.Noise, 2782, 1534, 255, 0, 500, SoundExpressionEffect.Vibrato, InterpolationCurve.Linear), SoundExpressionPlayMode.InBackground)
    projectile_cool_down()
    pause(cool_down)
    controller.configureRepeatEventDefaults(1000, 1000)
    projectile_thrown = 1
})
function Ending_2 () {
    MC.destroy()
    patient_1.destroy()
    music.powerUp.play()
    game.setDialogCursor(img`
        2 2 2 2 2 2 2 2 2 2 2 2 
        2 2 2 2 2 2 2 2 2 2 2 2 
        2 2 1 1 1 f 1 1 1 1 2 2 
        2 2 1 1 1 f 1 1 1 1 2 2 
        2 2 1 1 1 f 1 1 1 1 2 2 
        2 2 1 1 1 f f f f f 2 2 
        2 2 f f f f f 1 1 1 2 2 
        2 2 1 1 1 1 f 1 1 1 2 2 
        2 2 1 1 1 1 f 1 1 1 2 2 
        2 2 1 1 1 1 f 1 1 1 2 2 
        2 2 2 2 2 2 2 2 2 2 2 2 
        2 2 2 2 2 2 2 2 2 2 2 2 
        `)
    game.showLongText("You have succeeded in treating your patient!", DialogLayout.Center)
    game.over(true, effects.starField)
}
/**
 * Overlap event where the enemy takes damage if the player's projectile hits it.
 */
function game_play_explanation () {
    game.setDialogFrame(assets.image`Picture frame`)
    game.showLongText("It's the 1950s. You play as a German psychiatrist who has some unorthodox methods to treat his patients.", DialogLayout.Center)
    game.showLongText("Find your patient, he is located at the bottom of the \"battlefield\".", DialogLayout.Center)
    game.showLongText("You need to find and defeat him before \"sunset\".", DialogLayout.Center)
    main_menu()
}
/**
 * Crouching mechanic(?)
 */
controller.player2.onButtonEvent(ControllerButton.Down, ControllerButtonEvent.Pressed, function () {
    scaling.scaleByPercent(MC, -30, ScaleDirection.Uniformly, ScaleAnchor.Bottom)
})
/**
 * Sets up the enemy's projectiles.
 */
spriteutils.onSpriteKindUpdateInterval(SpriteKind.Enemy, 1500, function (sprite) {
    enemy_projectiles = sprites.createProjectileFromSprite(assets.image`enemy_1_projectile`, patient_1_enemy, -60, 0)
    enemy_projectiles.setKind(SpriteKind.enemy_projectile)
    animation.runImageAnimation(
    enemy_projectiles,
    assets.animation`patient_1_projectile`,
    75,
    true
    )
    enemy_projectiles.startEffect(effects.trail)
    enemy_projectiles.x += randint(-5, -8)
    enemy_projectiles.y += randint(-13, 20)
})
controller.player2.onButtonEvent(ControllerButton.Down, ControllerButtonEvent.Released, function () {
    scaling.scaleByPercent(MC, 30, ScaleDirection.Uniformly, ScaleAnchor.Bottom)
})
info.onCountdownEnd(function () {
    results_screen_2()
})
function results_screen_2 () {
    info.stopCountdown()
    MC.destroy()
    patient_1_enemy.destroy()
    game.setDialogFrame(assets.image`Picture frame`)
    game.setDialogCursor(assets.image`swastika`)
    carnival.customGameOverExpanded("You failed!", effects.melt, music.powerDown)
}
/**
 * Trying to destroy enemy projectiles when the patient's sprite is created.
 */
statusbars.onZero(StatusBarKind.EnemyHealth, function (status) {
    status.spriteAttachedTo().destroy(effects.halo, 500)
    patient_1_enemy.setFlag(SpriteFlag.AutoDestroy, true)
    pause(500)
    set_patient_1_position()
})
/**
 * Positions the MC and sets the MC's lives.
 */
function MCs_position () {
    MC = sprites.create(assets.image`MC sprite idle`, SpriteKind.Player)
    tiles.placeOnTile(MC, tiles.getTileLocation(10, 6))
    MC.ay = gravity
    MC.setFlag(SpriteFlag.StayInScreen, true)
    scene.cameraFollowSprite(MC)
    info.setLife(3)
    controller.moveSprite(MC, player_speed, 0)
    controller.player2.moveSprite(MC, player_speed, 0)
}
/**
 * Simple jump mechanic.
 */
controller.player2.onButtonEvent(ControllerButton.Up, ControllerButtonEvent.Pressed, function () {
    if (MC.isHittingTile(CollisionDirection.Bottom)) {
        music.playSoundEffect(music.createSoundEffect(WaveShape.Triangle, 400, 600, 255, 0, 100, SoundExpressionEffect.None, InterpolationCurve.Linear), SoundExpressionPlayMode.InBackground)
        spriteutils.jumpImpulse(MC, 50)
    }
})
function patient_negotiation () {
    animation.runImageAnimation(
    patient_1,
    assets.animation`Patient_1_idle_animation`,
    500,
    true
    )
    info.setScore(0)
    story.spriteSayText(patient_1, "Oh, so you've broken my shell...", 15, 1, story.TextSpeed.Normal)
    story.spriteSayText(patient_1, "Doctor, I need your advice.", 15, 1, story.TextSpeed.Normal)
    story.spriteSayText(patient_1, "I've been having the same kind of repeated nightmares recently,", 15, 1, story.TextSpeed.Normal)
    story.spriteSayText(patient_1, "And I need to know what's been causing them.", 15, 1, story.TextSpeed.Fast)
    story.showPlayerChoices("Hmm, give me an insight to your past.", "Oh?")
    if (story.checkLastAnswer("Hmm, give me an insight to your past.")) {
        info.changeScoreBy(10)
    }
    if (story.checkLastAnswer("Oh?")) {
        info.changeScoreBy(3)
    }
    story.spriteSayText(patient_1, "Let me give you an idea:", 15, 1, story.TextSpeed.Normal)
    story.spriteSayText(patient_1, "Do you know where I've been? What I've seen?", 15, 1, story.TextSpeed.Fast)
    pause(200)
    story.showPlayerChoices("You're a soldier, I assume you've accomplished many things.", "Not at all")
    if (story.checkLastAnswer("You're a soldier, I assume you've accomplished many things.")) {
        info.changeScoreBy(10)
        story.spriteSayText(patient_1, "Then let me ask:", 15, 1, story.TextSpeed.Slow)
    }
    if (story.checkLastAnswer("Not at all")) {
        info.changeScoreBy(-10)
    }
    story.spriteSayText(patient_1, "Have you had to kill anyone before?", 15, 1, story.TextSpeed.Fast)
    pause(100)
    story.spriteSayText(patient_1, "Have you ever been killed before?", 15, 1, story.TextSpeed.Normal)
    story.showPlayerChoices("Well of course not.", "...")
    if (story.checkLastAnswer("Well of course not.")) {
        info.changeScoreBy(10)
        story.spriteSayText(patient_1, "...", 15, 1, story.TextSpeed.VerySlow)
    }
    if (story.checkLastAnswer("...")) {
        info.changeScoreBy(-5)
    }
    story.spriteSayText(patient_1, "Have you ever been so haunted by shame and regret?", 15, 1, story.TextSpeed.VeryFast)
    story.spriteSayText(patient_1, "So much so that you cried until you puked?", 15, 1, story.TextSpeed.VeryFast)
    story.spriteSayText(patient_1, "And everyone around you would say to just \"Suck it up.\"", 15, 1, story.TextSpeed.VeryFast)
    pause(200)
    story.spriteSayText(patient_1, "Have you ever had friends that were told the exact same thing?", 15, 1, story.TextSpeed.VeryFast)
    story.spriteSayText(patient_1, "And took their lives for it?", 15, 1, story.TextSpeed.VeryFast)
    story.showPlayerChoices("I can't say that I have.", "Grief can be extremely difficult to move on from.")
    if (story.checkLastAnswer("I can't say that I have.")) {
        info.changeScoreBy(-5)
        story.spriteSayText(patient_1, "No, of course not...", 15, 1, story.TextSpeed.Normal)
        story.spriteSayText(patient_1, "I seem to be the only one who is affected by what I've seen.", 15, 1, story.TextSpeed.Normal)
        story.spriteSayText(patient_1, "I don't see how any normal person could understand.", 15, 1, story.TextSpeed.Normal)
        story.spriteSayText(patient_1, "Thanks for seeing me, doctor.", 15, 1, story.TextSpeed.Normal)
        game.setDialogFrame(assets.image`Documents`)
        game.setDialogCursor(assets.image`Dialogue choice`)
        music.jumpUp.play()
        game.showLongText("You have earned 9 Deutschemarks. ", DialogLayout.Center)
        Ending_1()
    }
    if (story.checkLastAnswer("Grief can be extremely difficult to move on from.")) {
        info.changeScoreBy(20)
        story.spriteSayText(patient_1, "And I don't understand why I keep reliving these things that I've seen!", 15, 1, story.TextSpeed.Normal)
        story.showPlayerChoices("There isn't a treatment for nightmares.", "You may be experiencing Shell Shock.")
        if (story.checkLastAnswer("There isn't a treatment for nightmares.")) {
            info.changeScoreBy(-50)
            story.spriteSayText(patient_1, "I knew no medical professional could understand.", 15, 1, story.TextSpeed.Fast)
            story.spriteSayText(patient_1, "Thank you for listening anyway, doctor.", 15, 1, story.TextSpeed.Normal)
            game.setDialogFrame(assets.image`Documents`)
            game.setDialogCursor(assets.image`Dialogue choice`)
            music.jumpUp.play()
            game.showLongText("You have earned 9 Deutschemarks. ", DialogLayout.Center)
            Ending_1()
        }
        if (story.checkLastAnswer("You may be experiencing Shell Shock.")) {
            info.changeScoreBy(30)
            story.spriteSayText(patient_1, "I've heard of that before!", 15, 1, story.TextSpeed.Normal)
            story.spriteSayText(patient_1, "You're the first person who has listened to me.", 15, 1, story.TextSpeed.Normal)
            story.spriteSayText(patient_1, "Thank you.", 15, 1, story.TextSpeed.Slow)
            game.setDialogFrame(assets.image`Documents`)
            game.setDialogCursor(assets.image`Dialogue choice`)
            music.jumpUp.play()
            game.showLongText("You have earned 9 Deutschemarks. ", DialogLayout.Center)
            Ending_2()
        }
    }
}
function Day_1 () {
    game.splash("Patient no. 1", "23rd November 1953")
    scene.setBackgroundImage(assets.image`MC office background`)
    game.setDialogFrame(assets.image`Documents`)
    game.setDialogCursor(img`
        2 2 2 f f 2 2 2 
        2 2 2 f d f 2 2 
        2 2 2 f f 2 2 2 
        f f f f f f f f 
        2 f f f f f f 2 
        2 2 f f f f 2 2 
        2 2 f f f f 2 2 
        2 2 2 f f 2 2 2 
        `)
    game.setDialogTextColor(15)
    game.showLongText("Patient case info:      " + "Name: Leon Bauer     " + "Age: 30          " + "Occupation: soldier", DialogLayout.Full)
    game.setDialogFrame(img`
        c c c c c c c c c c c c c c c 
        c c c c c c c c c c c c c c c 
        c c c c c c c c c c c c c c c 
        c c c 1 1 1 1 1 1 1 1 1 c c c 
        c c c 1 1 1 1 1 1 1 1 1 c c c 
        c c c 1 1 1 1 1 1 1 1 1 c c c 
        c c c 1 1 1 1 1 1 1 1 1 c c c 
        c c c 1 1 1 1 1 1 1 1 1 c c c 
        c c c 1 1 1 1 1 1 1 1 1 c c c 
        c c c 1 1 1 1 1 1 1 1 1 c c c 
        c c c 1 1 1 1 1 1 1 1 1 c c c 
        c c c 1 1 1 1 1 1 1 1 1 c c c 
        c c c c c c c c c c c c c c c 
        c c c c c c c c c c c c c c c 
        c c c c c c c c c c c c c c c 
        `)
    game.showLongText("He asked to see me in private...", DialogLayout.Bottom)
    game.showLongText("He could prove hard to treat.", DialogLayout.Bottom)
    level_1()
}
function results_screen_1 () {
    info.stopCountdown()
    music.powerUp.play()
    game.setDialogFrame(assets.image`Picture frame`)
    game.showLongText("You succeeded in getting your patient to open up, well done.", DialogLayout.Center)
    patient_negotiation()
}
/**
 * Positions the enemy and creates a health bar for them.
 */
function set_patient_1_enemy () {
    patient_1_enemy = sprites.create(assets.image`Patient_1_enemy_sprite`, SpriteKind.Enemy)
    tiles.placeOnTile(patient_1_enemy, tiles.getTileLocation(14, 96))
    characterAnimations.loopFrames(
    patient_1_enemy,
    assets.animation`patient_1_enemy_idle_animation`,
    1000,
    characterAnimations.rule(Predicate.NotMoving)
    )
    patient_1_enemy.ay = gravity
    status_bar = statusbars.create(30, 4, StatusBarKind.EnemyHealth)
    status_bar.attachToSprite(patient_1_enemy)
    status_bar.positionDirection(CollisionDirection.Top)
    status_bar.setStatusBarFlag(StatusBarFlag.SmoothTransition, true)
    status_bar.setColor(2, 7)
}
/**
 * The bad ending, resulting in a game over.
 */
function Ending_1 () {
    MC.destroy()
    patient_1.destroy()
    music.powerDown.play()
    game.setDialogCursor(img`
        2 2 2 2 2 2 2 2 2 2 2 2 
        2 2 2 2 2 2 2 2 2 2 2 2 
        2 2 1 1 1 f 1 1 1 1 2 2 
        2 2 1 1 1 f 1 1 1 1 2 2 
        2 2 1 1 1 f 1 1 1 1 2 2 
        2 2 1 1 1 f f f f f 2 2 
        2 2 f f f f f 1 1 1 2 2 
        2 2 1 1 1 1 f 1 1 1 2 2 
        2 2 1 1 1 1 f 1 1 1 2 2 
        2 2 1 1 1 1 f 1 1 1 2 2 
        2 2 2 2 2 2 2 2 2 2 2 2 
        2 2 2 2 2 2 2 2 2 2 2 2 
        `)
    game.showLongText("You haven't succeeded in treating your patient.", DialogLayout.Center)
    game.over(false, effects.dissolve)
}
function set_MC_projectiles () {
    if (projectile_thrown == 1) {
        if (characterAnimations.matchesRule(MC, characterAnimations.rule(Predicate.FacingRight))) {
            MCs_magic = sprites.createProjectileFromSprite(assets.image`MC projectile`, MC, 120, 5)
        }
        if (characterAnimations.matchesRule(MC, characterAnimations.rule(Predicate.FacingLeft))) {
            MCs_magic = sprites.createProjectileFromSprite(assets.image`MC projectile`, MC, -120, -5)
        }
        MCs_magic.x += 20
        MCs_magic.y += 8
        MCs_magic.startEffect(effects.warmRadial, 1000)
        scene.cameraShake(1, 100)
        animation.runImageAnimation(
        MCs_magic,
        assets.animation`MC animated projectile`,
        75,
        true
        )
        projectile_thrown = 0
    }
}
/**
 * A cool down function, so players can't spam projectiles and win too easily.
 */
function projectile_cool_down () {
    cool_down = 900
    projectile_thrown = 0
}
controller.B.onEvent(ControllerButtonEvent.Released, function () {
    animation.stopAnimation(animation.AnimationTypes.ImageAnimation, MC)
})
/**
 * The main menu for the game which lets the player choose to start the game or read about the lore behind the game.
 */
/**
 * The start of a battle sequence. Here, the level is loaded and key components like gravity is set.
 */
function main_menu () {
    story.showPlayerChoices("Start", "Controls", "Game play")
    if (story.checkLastAnswer("Start")) {
        music.sonar.play()
        Day_1()
    }
    if (story.checkLastAnswer("Controls")) {
        controls()
    }
    if (story.checkLastAnswer("Game play")) {
        game_play_explanation()
    }
}
/**
 * Overlap events when the player finds the patient's possessions.
 */
sprites.onOverlap(SpriteKind.Player, SpriteKind.Object, function (sprite, otherSprite) {
    if (MC.overlapsWith(Gun)) {
        game.setDialogFrame(assets.image`dirtied documents`)
        game.setDialogCursor(img`
            2 2 2 f f 2 2 2 
            2 2 2 f d f 2 2 
            2 2 2 f f 2 2 2 
            f f f f f f f f 
            2 f f f f f f 2 
            2 2 f f f f 2 2 
            2 2 f f f f 2 2 
            2 2 2 f f 2 2 2 
            `)
        game.showLongText("A P-38. Could this have been the type of pistol he used to fight?", DialogLayout.Center)
        Gun.destroy(effects.disintegrate, 1000)
    }
    if (MC.overlapsWith(Photograph)) {
        game.setDialogFrame(assets.image`dirtied documents`)
        game.showLongText("A family photograph? He clearly values others a lot.", DialogLayout.Center)
        Photograph.destroy(effects.fire, 1000)
    }
    if (MC.overlapsWith(Lighter)) {
        game.setDialogFrame(assets.image`dirtied documents`)
        game.showLongText("A Barton lighter. Perhaps he used this to pass the time with his friends in the trenches.", DialogLayout.Center)
        Lighter.destroy(effects.disintegrate, 1000)
    }
})
/**
 * Brief explanation of the controls.
 */
function controls () {
    game.showLongText("For computer users:    " + "←→:move        " + "↑:jump     " + "↓:crouch       " + "F:fire " + "WS:dialogue", DialogLayout.Full)
    game.showLongText("For mobile users:    " + "D-pad: to move         " + "Up: jump                " + "Down: crouch            " + "B: fire                " + "Up&down: dialogue", DialogLayout.Full)
    main_menu()
}
sprites.onOverlap(SpriteKind.Projectile, SpriteKind.Enemy, function (sprite, otherSprite) {
    sprite.destroy()
    statusbars.getStatusBarAttachedTo(StatusBarKind.EnemyHealth, patient_1_enemy).value += -8
})
/**
 * Creates and animates the projectile from the player. Adds effects for when the projectile is thrown. Positions the projectile to follow the enemy.
 */
function level_1 () {
    scene.setBackgroundImage(img`
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
        `)
    effects.clouds.startScreenEffect()
    tiles.setCurrentTilemap(tilemap`Cuphead`)
    gravity = 300
    jump_height = 90
    player_speed = 100
    projectile_velocity = 150
    cool_down = 500
    jump_velocity = 0 - Math.sqrt(2 * (gravity * jump_height))
    MCs_position()
    set_patient_1_enemy()
    game_timer_1()
    patients_memories()
}
/**
 * Overlap event where the player loses all their lives if the player overlaps the enemy and it results in a game over.
 */
sprites.onOverlap(SpriteKind.Player, SpriteKind.Enemy, function (sprite, otherSprite) {
    sprite.destroy()
    otherSprite.destroy()
    info.changeLifeBy(-3)
    scene.cameraShake(3, 1000)
    results_screen_2()
})
/**
 * A quick splash screen of a potential title for the game.
 */
let jump_velocity = 0
let projectile_velocity = 0
let jump_height = 0
let MCs_magic: Sprite = null
let status_bar: StatusBarSprite = null
let player_speed = 0
let projectile_thrown = 0
let cool_down = 0
let gravity = 0
let patient_1: Sprite = null
let patient_1_enemy: Sprite = null
let MC: Sprite = null
let enemy_projectiles: Sprite = null
let Lighter: Sprite = null
let Photograph: Sprite = null
let Gun: Sprite = null
music.bigCrash.play()
scene.setBackgroundColor(15)
game.setDialogCursor(assets.image`cursor`)
game.splash("A Means of Escape")
pause(100)
main_menu()
game.onUpdate(function () {
    characterAnimations.loopFrames(
    MC,
    assets.animation`MC idle animation right`,
    600,
    characterAnimations.rule(Predicate.NotMoving, Predicate.FacingRight)
    )
    characterAnimations.loopFrames(
    MC,
    assets.animation`Mc idle animation left`,
    600,
    characterAnimations.rule(Predicate.NotMoving, Predicate.FacingLeft)
    )
    characterAnimations.loopFrames(
    MC,
    assets.animation`MC moving right`,
    600,
    characterAnimations.rule(Predicate.Moving, Predicate.FacingRight)
    )
    characterAnimations.loopFrames(
    MC,
    assets.animation`MC moving left`,
    600,
    characterAnimations.rule(Predicate.Moving, Predicate.FacingLeft)
    )
})
forever(function () {
    MakeyMakey.setSimulatorKeymap(
    MakeyMakey.PlayerNumber.ONE,
    MakeyMakey.MakeyMakeyKey.W,
    MakeyMakey.MakeyMakeyKey.S,
    MakeyMakey.MakeyMakeyKey.A,
    MakeyMakey.MakeyMakeyKey.D,
    MakeyMakey.MakeyMakeyKey.SPACE,
    MakeyMakey.MakeyMakeyKey.F
    )
    MakeyMakey.setSimulatorKeymap(
    MakeyMakey.PlayerNumber.TWO,
    MakeyMakey.MakeyMakeyKey.UP,
    MakeyMakey.MakeyMakeyKey.DOWN,
    MakeyMakey.MakeyMakeyKey.LEFT,
    MakeyMakey.MakeyMakeyKey.RIGHT,
    MakeyMakey.MakeyMakeyKey.G,
    MakeyMakey.MakeyMakeyKey.RIGHT_CLICK
    )
})
